<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>PageLust</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
  <style>
    .navbar-custom {
      background-color: #18520a;
    }
    .navbar-custom .nav-link,
    .navbar-custom .navbar-brand {
      color: white;
    }
    .navbar-custom .nav-link:hover {
      color: #d4d4d4;
    }
    .search-input {
      width: 300px;
    }
    .card-img-top {
      height: 300px;
      width: 100%;
      object-fit: contain;
      background-color: #f8f8f8;
      padding: 10px;
    }
    .card {
      height: 100%;
      min-height: 450px;
      transition: all 0.3s ease-in-out;
    }
    .card:hover {
      transform: scale(1.02);
      box-shadow: 0 8px 16px rgba(0,0,0,0.2);
    }
  </style>
</head>
<body>

<!-- NAVBAR -->
<nav class="navbar navbar-expand-lg navbar-custom">
  <div class="container-fluid px-4">
    <a class="navbar-brand fw-bold" href="#">PageLust</a>
    <button class="navbar-toggler bg-light" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
        <li class="nav-item"><a class="nav-link" href="#">Home</a></li>
        <li class="nav-item"><a class="nav-link" href="login.html">Login</a></li>
        <li class="nav-item"><a class="nav-link" href="contact.html">Contact</a></li>
        <li class="nav-item"><a class="nav-link" href="register.html">Register</a></li>
      </ul>
      <form class="d-flex mx-auto" role="search" onsubmit="return false;">
        <input class="form-control me-2 search-input" type="search" placeholder="Search for books" aria-label="Search" id="searchInput" oninput="liveSearch()">
      </form>
    </div>
  </div>
</nav>

<!-- BOOK CARDS -->
<div class="container mt-4">
  <div class="row g-4">

    <!-- Book 1 -->
    <div class="col-md-3">
      <div class="card h-100">
        <img src="https://encrypted-tbn1.gstatic.com/shopping?q=tbn:ANd9GcSkAvPwrC9EcbCdrwy9KyfoubNdb8V1p7m1KcVdiQ625AlNaP8Y8pz8LxlPZnefGrktsPSW0xSNZNj6U3lwoqBJIaHXA1LTmMGsasIWxQdXkZhXxp3n85pYQQ" class="card-img-top" alt="Jungle Book">
        <div class="card-body d-flex flex-column">
          <h5 class="card-title">Jungle Book</h5>
          <p class="card-text">⭐⭐⭐⭐☆</p>
          <div class="mt-auto">
            <button class="btn btn-success me-2">Add to Cart</button>
            <button class="btn btn-primary">Buy Now</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Book 2 -->
    <div class="col-md-3">
      <div class="card h-100">
        <img src="https://encrypted-tbn3.gstatic.com/shopping?q=tbn:ANd9GcSWX2zNw9WrVpziQ3iL5v5yNpN51isywIytdj6cKeLopynwHz2mshD5C4DwfOCejre8PwQL7REoXEAJC4Z6sj16IuxE2Vz8KX3Z_m8sg_-L" class="card-img-top" alt="Looking for Alaska">
        <div class="card-body d-flex flex-column">
          <h5 class="card-title">Looking for Alaska</h5>
          <p class="card-text">⭐⭐⭐⭐⭐</p>
          <div class="mt-auto">
            <button class="btn btn-success me-2">Add to Cart</button>
            <button class="btn btn-primary">Buy Now</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Book 3 -->
    <div class="col-md-3">
      <div class="card h-100">
        <img src="https://encrypted-tbn3.gstatic.com/shopping?q=tbn:ANd9GcR8SI4EDOZBMPN7eRxLP32hfbQPtyUaFsnShi0wjj9RblZfyczbQdqrkZDhHVtjQ722CjPlpSUqaB3kqgcYhQPMJNqcW7FMhPvJszUfcVQY" class="card-img-top" alt="Dhoni">
        <div class="card-body d-flex flex-column">
          <h5 class="card-title">DHONI: The Legend</h5>
          <p class="card-text">⭐⭐⭐⭐⭐</p>
          <div class="mt-auto">
            <button class="btn btn-success me-2">Add to Cart</button>
            <button class="btn btn-primary">Buy Now</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Book 4 -->
    <div class="col-md-3">
      <div class="card h-100">
        <img src="https://covers.openlibrary.org/b/id/10515199-L.jpg" class="card-img-top" alt="1984">
        <div class="card-body d-flex flex-column">
          <h5 class="card-title">1984</h5>
          <p class="card-text">⭐⭐⭐⭐☆</p>
          <div class="mt-auto">
            <button class="btn btn-success me-2">Add to Cart</button>
            <button class="btn btn-primary">Buy Now</button>
          </div>
        </div>
      </div>
    </div>

  </div>
</div>

<!-- BUY NOW MODAL -->
<div class="modal fade" id="buyNowModal" tabindex="-1" aria-labelledby="buyNowModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content">
      <div class="modal-header bg-success text-white">
        <h5 class="modal-title" id="buyNowModalLabel">Buy Book</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body d-flex">
        <img id="modalBookImage" src="" alt="Book Image" class="img-thumbnail me-4" style="width: 200px; height: auto;">
        <div class="flex-grow-1">
          <h4 id="modalBookTitle">Book Title</h4>
          <p><strong>Price:</strong> ₹<span id="modalPrice">499</span></p>
          <div class="d-flex align-items-center mb-3">
            <label class="me-2">Quantity:</label>
            <button class="btn btn-outline-secondary" onclick="updateQuantity(-1)">−</button>
            <input id="quantityInput" type="number" class="form-control mx-2 text-center" value="1" min="1" style="width: 60px;" onchange="calculateTotal()">
            <button class="btn btn-outline-secondary" onclick="updateQuantity(1)">+</button>
          </div>
          <hr>
          <p><strong>Subtotal:</strong> ₹<span id="subtotal">499</span></p>
          <p><strong>Delivery:</strong> ₹<span id="delivery">50</span></p>
          <p class="fw-bold"><strong>Total:</strong> ₹<span id="total">549</span></p>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-success" id="proceedToPaymentBtn">Proceed to Pay</button>
      </div>
    </div>
  </div>
</div>

<!-- JS for Bootstrap and Functionality -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script>
  function liveSearch() {
    const query = document.getElementById("searchInput").value.toLowerCase();
    const cards = document.querySelectorAll(".card");

    cards.forEach(card => {
      const title = card.querySelector(".card-title").innerText.toLowerCase();
      if (title.includes(query)) {
        card.style.display = "block";
      } else {
        card.style.display = "none";
      }
    });
  }

  function isRegistered() {
    return localStorage.getItem("isRegistered") === "true";
  }

  function isLoggedIn() {
    return localStorage.getItem("isLoggedIn") === "true";
  }

  function openBuyNowModal(imageSrc, title) {
    document.getElementById('modalBookImage').src = imageSrc;
    document.getElementById('modalBookTitle').innerText = title;
    document.getElementById('subtotal').innerText = 499;
    document.getElementById('total').innerText = 549;
    document.getElementById('quantityInput').value = 1;
    document.getElementById('delivery').innerText = 50;

    const modal = new bootstrap.Modal(document.getElementById('buyNowModal'));
    modal.show();
  }

  function updateQuantity(change) {
    const quantityInput = document.getElementById('quantityInput');
    let quantity = parseInt(quantityInput.value) + change;
    if (quantity < 1) quantity = 1;
    quantityInput.value = quantity;
    calculateTotal();
  }

  function calculateTotal() {
    const quantity = parseInt(document.getElementById('quantityInput').value);
    const price = 499;
    const delivery = 50;
    const subtotal = price * quantity;
    const total = subtotal + delivery;

    document.getElementById('subtotal').innerText = subtotal;
    document.getElementById('total').innerText = total;
    document.getElementById('delivery').innerText = delivery;
  }

  function proceedToPay() {
    if (!isRegistered()) {
      alert("You must register before proceeding to payment.");
      window.location.href = "register.html";
      return;
    }

    if (!isLoggedIn()) {
      alert("Please login to proceed.");
      window.location.href = "login.html";
      return;
    }

    alert("Redirecting to payment...");
    window.location.href = "processed.html";
  }

  document.addEventListener('DOMContentLoaded', () => {
    document.querySelectorAll('.btn-primary').forEach(button => {
      button.addEventListener('click', function () {
        if (!isRegistered()) {
          alert("You must register first!");
          window.location.href = "register.html";
          return;
        }

        if (!isLoggedIn()) {
          alert("Please login to continue!");
          window.location.href = "login.html";
          return;
        }

        const card = this.closest('.card');
        const image = card.querySelector('img').src;
        const title = card.querySelector('.card-title').innerText;
        openBuyNowModal(image, title);
      });
    });

    document.querySelector('#proceedToPaymentBtn').addEventListener('click', function () {
      proceedToPay();
    });
  });
</script>

</body>
</html>
